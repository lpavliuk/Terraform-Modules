# AWS S3 Bucket Module

This module creates AWS S3 Bucket with custom policies: `Read_Only`, `WriteRead_Only`, and `FullAccess`.

<!-- Next block is generated by terraform-docs following .terraform-docs.yml config -->
<!-- BEGIN_TF_DOCS -->
## Example

```hcl
# main.tf
module "s3_bucket" {
  source    = "../../../../modules/aws_s3_bucket"

  bucket_prefix                      = "bucket-name-"
  enable_versioning                  = true
  create_iam_policies                = false

  noncurrent_version_expiration_days = 14
}
```

## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | < 2.0.0, >= 1.6.6 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | < 6.0, >= 5.22 |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_bucket_prefix"></a> [bucket\_prefix](#input\_bucket\_prefix) | Bucket Prefix. The full bucket name will be generated by AWS module | `string` | n/a | yes |
| <a name="input_is_public"></a> [is\_public](#input\_is\_public) | Defines whether the bucket is public. | `bool` | `false` | no |
| <a name="input_enable_versioning"></a> [enable\_versioning](#input\_enable\_versioning) | Enable bucket versioning | `bool` | `false` | no |
| <a name="input_create_iam_policies"></a> [create\_iam\_policies](#input\_create\_iam\_policies) | Create custom IAM Policies: `Read_Only`, `WriteRead_Only`, and `FullAccess` | `bool` | `false` | no |
| <a name="input_keep_last_versions_number"></a> [keep\_last\_versions\_number](#input\_keep\_last\_versions\_number) | Number of last non-current versions to retain forever | `number` | `0` | no |
| <a name="input_current_version_expiration_days"></a> [current\_version\_expiration\_days](#input\_current\_version\_expiration\_days) | Number of days a current version expires. NOTE: `0` disables the expiration | `number` | `0` | no |
| <a name="input_noncurrent_version_expiration_days"></a> [noncurrent\_version\_expiration\_days](#input\_noncurrent\_version\_expiration\_days) | Number of days a non-current version expires | `number` | `30` | no |
| <a name="input_version_transitions"></a> [version\_transitions](#input\_version\_transitions) | Version Transitions settings. Available `storage_class`:<br>  - `GLACIER`<br>  - `STANDARD_IA`<br>  - `ONEZONE_IA`<br>  - `INTELLIGENT_TIERING`<br>  - `DEEP_ARCHIVE`<br>  - `GLACIER_IR` | <pre>list(object({<br>    keep_last_versions_number = optional(number)<br>    after_days                = number<br>    storage_class             = string<br>  }))</pre> | `[]` | no |
| <a name="input_expired_object_delete_marker"></a> [expired\_object\_delete\_marker](#input\_expired\_object\_delete\_marker) | Indicates whether Amazon S3 will remove a delete marker with no noncurrent versions.<br>Conflicts with `current_version_expiration_days` | `bool` | `true` | no |
| <a name="input_abort_incomplete_multipart_upload_after_days"></a> [abort\_incomplete\_multipart\_upload\_after\_days](#input\_abort\_incomplete\_multipart\_upload\_after\_days) | Days since the initiation of an incomplete multipart upload that Amazon S3 will wait before<br>permanently removing all parts of the upload | `number` | `1` | no |
| <a name="input_enable_replication"></a> [enable\_replication](#input\_enable\_replication) | Enable bucket replication | `bool` | `false` | no |
| <a name="input_replica_bucket_arn"></a> [replica\_bucket\_arn](#input\_replica\_bucket\_arn) | S3 Bucket ARN that objects will be replicating to | `string` | `""` | no |
| <a name="input_delete_marker_replication"></a> [delete\_marker\_replication](#input\_delete\_marker\_replication) | Enable Delete Marker replication | `bool` | `false` | no |
| <a name="input_aws_cli_profile"></a> [aws\_cli\_profile](#input\_aws\_cli\_profile) | AWS CLI Profile used for this module. Used to execute AWS CLI `local-exec` commands absent in Terraform | `string` | `""` | no |
| <a name="input_force_destroy"></a> [force\_destroy](#input\_force\_destroy) | Allow S3 bucket destruction regardless existed objects | `bool` | `false` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_id"></a> [id](#output\_id) | Bucket ID |
| <a name="output_arn"></a> [arn](#output\_arn) | Bucket ARN |
| <a name="output_name"></a> [name](#output\_name) | Bucket Name |
| <a name="output_domain_name"></a> [domain\_name](#output\_domain\_name) | Bucket Regional Domain Name |
| <a name="output_cross_region_replication"></a> [cross\_region\_replication](#output\_cross\_region\_replication) | Bucket replication enabled status |
| <a name="output_replica_bucket_arn"></a> [replica\_bucket\_arn](#output\_replica\_bucket\_arn) | Replica bucket ARN that objects are replicated to |
| <a name="output_iam_policy_read_only_arn"></a> [iam\_policy\_read\_only\_arn](#output\_iam\_policy\_read\_only\_arn) | Custom Read Only IAM Policy ARN |
| <a name="output_iam_policy_write_read_only_arn"></a> [iam\_policy\_write\_read\_only\_arn](#output\_iam\_policy\_write\_read\_only\_arn) | Custom Write and Read Only IAM Policy ARN |
| <a name="output_iam_policy_full_access_arn"></a> [iam\_policy\_full\_access\_arn](#output\_iam\_policy\_full\_access\_arn) | Custom Full Access IAM Policy ARN |

## Resources

| Name | Type |
|------|------|
| [aws_iam_policy.full_access](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy) | resource |
| [aws_iam_policy.read_only](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy) | resource |
| [aws_iam_policy.write_read_only](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy) | resource |
| [aws_iam_role.replication](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role) | resource |
| [aws_iam_role.s3_batch_operation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role) | resource |
| [aws_s3_bucket.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket) | resource |
| [aws_s3_bucket_acl.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_acl) | resource |
| [aws_s3_bucket_lifecycle_configuration.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_lifecycle_configuration) | resource |
| [aws_s3_bucket_ownership_controls.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_ownership_controls) | resource |
| [aws_s3_bucket_public_access_block.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block) | resource |
| [aws_s3_bucket_replication_configuration.replication](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_replication_configuration) | resource |
| [aws_s3_bucket_versioning.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_versioning) | resource |
| [null_resource.s3_batch_operation](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource) | resource |
| [aws_caller_identity.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/caller_identity) | data source |
| [aws_iam_policy_document.replica_role](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) | data source |
| [aws_iam_policy_document.replication](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) | data source |
| [aws_iam_policy_document.s3_batch_operation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) | data source |
| [aws_iam_policy_document.s3_batch_operation_role](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) | data source |
| [aws_region.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/region) | data source |
<!-- END_TF_DOCS -->