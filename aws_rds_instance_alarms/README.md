# AWS RDS Instance Alarms Module

This module creates AWS CloudWatch Alarms for AWS RDS Instance (Database) Metrics.

<!-- Next block is generated by terraform-docs following .terraform-docs.yml config -->
<!-- BEGIN_TF_DOCS -->
## Example

```hcl
# main.tf
module "rds_instance" {
  source = "git::https://github.com/lpavliuk/Terraform-Modules.git//aws_rds_instance_mysql"

  name                       = local.codename
  instance_type              = "db.t3.micro"
  storage_size_gb            = "20"
  storage_type               = "gp3"
  mysql_engine_version       = "8.0.33"
  vpc_id                     = local.vpc_id
  rds_subnet_group_id        = local.rds_subnet_group_id

  manage_master_user_pswd           = true
  is_private                        = true
  multi_az                          = true
  enable_enhanced_monitoring        = true
  enable_auto_minor_version_upgrade = true
  backup_retention_period_days      = 0                     # [!] Disabled as AWS Backup is used!
  backup_window_utc_period          = "14:00-16:00"         # UTC => 01:00-03:00 Sydney AEDT
  maintenance_window_utc_period     = "Sat:16:00-Sat:18:00" # UTC => Sun 03:00-05:00 Sydney AEDT

  cloudwatch_logs_exports               = ["error"]
  cloudwatch_logs_retention_period_days = 30

  aws_cli_profile            = local.account_config.aws_profile
}

module "rds_instance_alarms" {
  source = "git::https://github.com/lpavliuk/Terraform-Modules.git//aws_rds_instance_alarms"

  name_prefix       = "dev-"
  db_instance_name  = module.rds_instance.name
  db_instance_class = module.rds_instance.instance_class
  sns_topic_arns    = local.notifications_sns_topic_arns

  enable_burst_balance_alarms  = false

  read_iops_too_high_threshold      = 10
  freeable_memory_too_low_threshold = 60
}
```

## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | < 2.0.0, >= 1.6.6 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | < 6.0, >= 5.22 |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_name_prefix"></a> [name\_prefix](#input\_name\_prefix) | Prefix for CloudWatch alarms names | `string` | `""` | no |
| <a name="input_db_instance_name"></a> [db\_instance\_name](#input\_db\_instance\_name) | RDS Instance Name alarms will be created for | `string` | n/a | yes |
| <a name="input_db_instance_class"></a> [db\_instance\_class](#input\_db\_instance\_class) | RDS Instance Class for CloudWatch alarms names | `string` | n/a | yes |
| <a name="input_sns_topic_arns"></a> [sns\_topic\_arns](#input\_sns\_topic\_arns) | SNS Topic ARNs attached to CloudWatch alarms | `list(string)` | n/a | yes |
| <a name="input_evaluation_periods"></a> [evaluation\_periods](#input\_evaluation\_periods) | Evaluation period over which to use when triggering alarms | `number` | `5` | no |
| <a name="input_statistics_period"></a> [statistics\_period](#input\_statistics\_period) | Number of seconds that make each statistic period | `number` | `60` | no |
| <a name="input_enable_cpu_utilization_alarms"></a> [enable\_cpu\_utilization\_alarms](#input\_enable\_cpu\_utilization\_alarms) | Create CPU Utilization alarms | `bool` | `true` | no |
| <a name="input_enable_cpu_credit_balance_alarms"></a> [enable\_cpu\_credit\_balance\_alarms](#input\_enable\_cpu\_credit\_balance\_alarms) | Create CPU Credit Balance alarms | `bool` | `true` | no |
| <a name="input_enable_read_iops_alarms"></a> [enable\_read\_iops\_alarms](#input\_enable\_read\_iops\_alarms) | Create Read IOPS alarms | `bool` | `true` | no |
| <a name="input_enable_burst_balance_alarms"></a> [enable\_burst\_balance\_alarms](#input\_enable\_burst\_balance\_alarms) | Create Burst Balance alarms | `bool` | `true` | no |
| <a name="input_enable_disk_queue_depth_alarms"></a> [enable\_disk\_queue\_depth\_alarms](#input\_enable\_disk\_queue\_depth\_alarms) | Create Disk Queue Depth alarms | `bool` | `true` | no |
| <a name="input_enable_disk_free_storage_space_alarms"></a> [enable\_disk\_free\_storage\_space\_alarms](#input\_enable\_disk\_free\_storage\_space\_alarms) | Create Disk Free Storage Space alarms | `bool` | `true` | no |
| <a name="input_enable_freeable_memory_alarms"></a> [enable\_freeable\_memory\_alarms](#input\_enable\_freeable\_memory\_alarms) | Create Freeable Memory alarms | `bool` | `true` | no |
| <a name="input_enable_memory_swap_usage_alarms"></a> [enable\_memory\_swap\_usage\_alarms](#input\_enable\_memory\_swap\_usage\_alarms) | Create Swap Usage alarms | `bool` | `true` | no |
| <a name="input_enable_db_connections_alarms"></a> [enable\_db\_connections\_alarms](#input\_enable\_db\_connections\_alarms) | Create Database Connections alarms | `bool` | `true` | no |
| <a name="input_cpu_utilization_too_high_threshold"></a> [cpu\_utilization\_too\_high\_threshold](#input\_cpu\_utilization\_too\_high\_threshold) | The maximum percentage of CPU utilization | `number` | `80` | no |
| <a name="input_cpu_credit_balance_too_low_threshold"></a> [cpu\_credit\_balance\_too\_low\_threshold](#input\_cpu\_credit\_balance\_too\_low\_threshold) | The minimum number of CPU credits (t2 instances only) available | `number` | `50` | no |
| <a name="input_read_iops_too_high_threshold"></a> [read\_iops\_too\_high\_threshold](#input\_read\_iops\_too\_high\_threshold) | The number of IOPS is meant to be suspicious | `number` | `100` | no |
| <a name="input_burst_balance_too_low_threshold"></a> [burst\_balance\_too\_low\_threshold](#input\_burst\_balance\_too\_low\_threshold) | The minimum percent of General Purpose SSD (gp2) burst-bucket I/O credits available | `number` | `90` | no |
| <a name="input_disk_queue_depth_too_high_threshold"></a> [disk\_queue\_depth\_too\_high\_threshold](#input\_disk\_queue\_depth\_too\_high\_threshold) | The maximum number of outstanding IOs (read/write requests) waiting to access the disk | `number` | `64` | no |
| <a name="input_disk_free_storage_space_threshold"></a> [disk\_free\_storage\_space\_threshold](#input\_disk\_free\_storage\_space\_threshold) | The minimum amount of available storage space in Megabytes | `number` | `2000` | no |
| <a name="input_freeable_memory_too_low_threshold"></a> [freeable\_memory\_too\_low\_threshold](#input\_freeable\_memory\_too\_low\_threshold) | The minimum amount of available random access memory in Megabytes | `number` | `25` | no |
| <a name="input_memory_swap_usage_too_high_threshold"></a> [memory\_swap\_usage\_too\_high\_threshold](#input\_memory\_swap\_usage\_too\_high\_threshold) | The maximum amount of swap space used on the DB instance in Megabytes | `number` | `1000` | no |
| <a name="input_db_connections_limit_threshold"></a> [db\_connections\_limit\_threshold](#input\_db\_connections\_limit\_threshold) | The maximum percent of connections connected to the DB instance | `number` | `80` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_cpu_utilization_too_high_alarm_arn"></a> [cpu\_utilization\_too\_high\_alarm\_arn](#output\_cpu\_utilization\_too\_high\_alarm\_arn) | 'CPU Utilization Too High' alarm's ARN |
| <a name="output_cpu_utilization_too_high_alarm_name"></a> [cpu\_utilization\_too\_high\_alarm\_name](#output\_cpu\_utilization\_too\_high\_alarm\_name) | 'CPU Utilization Too High' alarm's Name |
| <a name="output_cpu_utilization_too_high_alarm_threshold"></a> [cpu\_utilization\_too\_high\_alarm\_threshold](#output\_cpu\_utilization\_too\_high\_alarm\_threshold) | 'CPU Utilization Too High' alarm's Threshold |
| <a name="output_cpu_credit_balance_too_low_alarm_arn"></a> [cpu\_credit\_balance\_too\_low\_alarm\_arn](#output\_cpu\_credit\_balance\_too\_low\_alarm\_arn) | 'CPU Credit Balance' alarm's ARN |
| <a name="output_cpu_credit_balance_too_low_alarm_name"></a> [cpu\_credit\_balance\_too\_low\_alarm\_name](#output\_cpu\_credit\_balance\_too\_low\_alarm\_name) | 'CPU Credit Balance' alarm's Name |
| <a name="output_cpu_credit_balance_too_low_alarm_threshold"></a> [cpu\_credit\_balance\_too\_low\_alarm\_threshold](#output\_cpu\_credit\_balance\_too\_low\_alarm\_threshold) | 'CPU Credit Balance' alarm's Threshold |
| <a name="output_read_iops_too_high_alarm_arn"></a> [read\_iops\_too\_high\_alarm\_arn](#output\_read\_iops\_too\_high\_alarm\_arn) | 'Read IOPS' alarm's ARN |
| <a name="output_read_iops_too_high_alarm_name"></a> [read\_iops\_too\_high\_alarm\_name](#output\_read\_iops\_too\_high\_alarm\_name) | 'Read IOPS' alarm's Name |
| <a name="output_read_iops_too_high_alarm_threshold"></a> [read\_iops\_too\_high\_alarm\_threshold](#output\_read\_iops\_too\_high\_alarm\_threshold) | 'Read IOPS' alarm's Threshold |
| <a name="output_burst_balance_too_low_alarm_arn"></a> [burst\_balance\_too\_low\_alarm\_arn](#output\_burst\_balance\_too\_low\_alarm\_arn) | 'Burst Balance' alarm's ARN |
| <a name="output_burst_balance_too_low_alarm_name"></a> [burst\_balance\_too\_low\_alarm\_name](#output\_burst\_balance\_too\_low\_alarm\_name) | 'Burst Balance' alarm's Name |
| <a name="output_burst_balance_too_low_alarm_threshold"></a> [burst\_balance\_too\_low\_alarm\_threshold](#output\_burst\_balance\_too\_low\_alarm\_threshold) | 'Burst Balance' alarm's Threshold |
| <a name="output_disk_queue_depth_too_high_alarm_arn"></a> [disk\_queue\_depth\_too\_high\_alarm\_arn](#output\_disk\_queue\_depth\_too\_high\_alarm\_arn) | 'Disk Queue Depth' alarm's ARN |
| <a name="output_disk_queue_depth_too_high_alarm_name"></a> [disk\_queue\_depth\_too\_high\_alarm\_name](#output\_disk\_queue\_depth\_too\_high\_alarm\_name) | 'Disk Queue Depth' alarm's Name |
| <a name="output_disk_queue_depth_too_high_alarm_threshold"></a> [disk\_queue\_depth\_too\_high\_alarm\_threshold](#output\_disk\_queue\_depth\_too\_high\_alarm\_threshold) | 'Disk Queue Depth' alarm's Threshold |
| <a name="output_freeable_memory_too_low_alarm_arn"></a> [freeable\_memory\_too\_low\_alarm\_arn](#output\_freeable\_memory\_too\_low\_alarm\_arn) | 'Freeable Memory' alarm's ARN |
| <a name="output_freeable_memory_too_low_alarm_name"></a> [freeable\_memory\_too\_low\_alarm\_name](#output\_freeable\_memory\_too\_low\_alarm\_name) | 'Freeable Memory' alarm's Name |
| <a name="output_freeable_memory_too_low_alarm_threshold"></a> [freeable\_memory\_too\_low\_alarm\_threshold](#output\_freeable\_memory\_too\_low\_alarm\_threshold) | 'Freeable Memory' alarm's Threshold |
| <a name="output_disk_free_storage_space_threshold_alarm_arn"></a> [disk\_free\_storage\_space\_threshold\_alarm\_arn](#output\_disk\_free\_storage\_space\_threshold\_alarm\_arn) | 'Disk Free Storage Space' alarm's ARN |
| <a name="output_disk_free_storage_space_threshold_alarm_name"></a> [disk\_free\_storage\_space\_threshold\_alarm\_name](#output\_disk\_free\_storage\_space\_threshold\_alarm\_name) | 'Disk Free Storage Space' alarm's Name |
| <a name="output_disk_free_storage_space_alarm_threshold"></a> [disk\_free\_storage\_space\_alarm\_threshold](#output\_disk\_free\_storage\_space\_alarm\_threshold) | 'Disk Free Storage Space' alarm's Threshold |
| <a name="output_memory_swap_usage_too_high_alarm_arn"></a> [memory\_swap\_usage\_too\_high\_alarm\_arn](#output\_memory\_swap\_usage\_too\_high\_alarm\_arn) | 'Swap Usage' alarm's ARN |
| <a name="output_memory_swap_usage_too_high_alarm_name"></a> [memory\_swap\_usage\_too\_high\_alarm\_name](#output\_memory\_swap\_usage\_too\_high\_alarm\_name) | 'Swap Usage' alarm's Name |
| <a name="output_memory_swap_usage_too_high_alarm_threshold"></a> [memory\_swap\_usage\_too\_high\_alarm\_threshold](#output\_memory\_swap\_usage\_too\_high\_alarm\_threshold) | 'Swap Usage' alarm's Threshold |
| <a name="output_db_connections_limit_alarm_arn"></a> [db\_connections\_limit\_alarm\_arn](#output\_db\_connections\_limit\_alarm\_arn) | 'Database Connections' alarm's ARN |
| <a name="output_db_connections_limit_alarm_name"></a> [db\_connections\_limit\_alarm\_name](#output\_db\_connections\_limit\_alarm\_name) | 'Database Connections' alarm's Name |
| <a name="output_db_connections_limit_alarm_threshold"></a> [db\_connections\_limit\_alarm\_threshold](#output\_db\_connections\_limit\_alarm\_threshold) | 'Database Connections' alarm's Threshold |

## Resources

| Name | Type |
|------|------|
| [aws_cloudwatch_metric_alarm.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_metric_alarm) | resource |
| [aws_db_event_subscription.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_event_subscription) | resource |
<!-- END_TF_DOCS -->